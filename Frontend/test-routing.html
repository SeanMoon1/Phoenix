<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>라우팅 및 네비게이션 테스트</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        max-width: 1000px;
        margin: 0 auto;
        padding: 20px;
        background-color: #f5f5f5;
      }
      .test-section {
        background: white;
        padding: 20px;
        margin: 20px 0;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }
      .test-button {
        background: #ff6b35;
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 5px;
        cursor: pointer;
        margin: 5px;
        text-decoration: none;
        display: inline-block;
      }
      .test-button:hover {
        background: #e55a2b;
      }
      .test-button.secondary {
        background: #6c757d;
      }
      .test-button.secondary:hover {
        background: #5a6268;
      }
      .result {
        background: #f8f9fa;
        padding: 10px;
        border-radius: 5px;
        margin: 10px 0;
        border-left: 4px solid #ff6b35;
      }
      .error {
        border-left-color: #dc3545;
        background: #f8d7da;
      }
      .success {
        border-left-color: #28a745;
        background: #d4edda;
      }
      .route-list {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 10px;
        margin: 10px 0;
      }
      .route-item {
        background: #f8f9fa;
        padding: 10px;
        border-radius: 5px;
        border-left: 3px solid #ff6b35;
      }
      .route-path {
        font-weight: bold;
        color: #ff6b35;
      }
      .route-component {
        color: #6c757d;
        font-size: 0.9em;
      }
    </style>
  </head>
  <body>
    <h1>🧭 라우팅 및 네비게이션 테스트</h1>

    <div class="test-section">
      <h2>1. 앱 라우트 구조 확인</h2>
      <p>Phoenix 앱의 모든 라우트를 확인합니다:</p>

      <div class="route-list">
        <div class="route-item">
          <div class="route-path">/</div>
          <div class="route-component">HomePage</div>
        </div>
        <div class="route-item">
          <div class="route-path">/login</div>
          <div class="route-component">LoginPage</div>
        </div>
        <div class="route-item">
          <div class="route-path">/register</div>
          <div class="route-component">RegisterPage</div>
        </div>
        <div class="route-item">
          <div class="route-path">/auth/callback</div>
          <div class="route-component">AuthCallbackPage</div>
        </div>
        <div class="route-item">
          <div class="route-path">/manual</div>
          <div class="route-component">ManualPage</div>
        </div>
        <div class="route-item">
          <div class="route-path">/training</div>
          <div class="route-component">TrainingPage</div>
        </div>
        <div class="route-item">
          <div class="route-path">/training/fire</div>
          <div class="route-component">FireScenarioPage</div>
        </div>
        <div class="route-item">
          <div class="route-path">/training/earthquake</div>
          <div class="route-component">EarthquakeScenarioPage</div>
        </div>
        <div class="route-item">
          <div class="route-path">/training/first-aid</div>
          <div class="route-component">EmergencyFirstAidScenarioPage</div>
        </div>
        <div class="route-item">
          <div class="route-path">/training/traffic-accident</div>
          <div class="route-component">TrafficAccidentScenarioPage</div>
        </div>
        <div class="route-item">
          <div class="route-path">/mypage</div>
          <div class="route-component">MyPage</div>
        </div>
        <div class="route-item">
          <div class="route-path">/support</div>
          <div class="route-component">SupportPage</div>
        </div>
        <div class="route-item">
          <div class="route-path">/admin</div>
          <div class="route-component">DashboardPage (Protected)</div>
        </div>
      </div>
    </div>

    <div class="test-section">
      <h2>2. 네비게이션 테스트</h2>
      <p>다양한 라우트로의 네비게이션을 테스트합니다:</p>

      <button class="test-button" onclick="testNavigation('/')">
        홈페이지
      </button>
      <button class="test-button" onclick="testNavigation('/login')">
        로그인
      </button>
      <button class="test-button" onclick="testNavigation('/register')">
        회원가입
      </button>
      <button class="test-button" onclick="testNavigation('/training')">
        훈련하기
      </button>
      <button class="test-button" onclick="testNavigation('/mypage')">
        마이페이지
      </button>
      <button class="test-button" onclick="testNavigation('/support')">
        고객지원
      </button>
      <button class="test-button secondary" onclick="testNavigation('/admin')">
        관리자 (보호됨)
      </button>

      <div id="nav-result" class="result" style="display: none"></div>
    </div>

    <div class="test-section">
      <h2>3. OAuth 콜백 라우팅 테스트</h2>
      <p>Google OAuth 콜백 후 리다이렉트를 테스트합니다:</p>

      <button class="test-button" onclick="testOAuthCallback()">
        OAuth 콜백 시뮬레이션
      </button>
      <button class="test-button" onclick="testOAuthError()">
        OAuth 에러 시뮬레이션
      </button>

      <div id="oauth-nav-result" class="result" style="display: none"></div>
    </div>

    <div class="test-section">
      <h2>4. 인증 상태별 라우팅 테스트</h2>
      <p>인증 상태에 따른 라우팅 동작을 테스트합니다:</p>

      <button class="test-button" onclick="testAuthenticatedRouting()">
        인증된 사용자 라우팅
      </button>
      <button class="test-button" onclick="testUnauthenticatedRouting()">
        미인증 사용자 라우팅
      </button>

      <div id="auth-routing-result" class="result" style="display: none"></div>
    </div>

    <div class="test-section">
      <h2>5. 현재 URL 정보</h2>
      <div id="current-url-info" class="result"></div>
    </div>

    <script>
      // 현재 URL 정보 표시
      function updateCurrentUrlInfo() {
        const info = {
          '현재 URL': window.location.href,
          경로: window.location.pathname,
          '쿼리 파라미터': window.location.search,
          해시: window.location.hash,
          호스트: window.location.host,
          프로토콜: window.location.protocol,
        };

        document.getElementById('current-url-info').innerHTML = `
                <strong>현재 브라우저 정보:</strong><br>
                <pre>${JSON.stringify(info, null, 2)}</pre>
            `;
      }

      function showResult(elementId, message, type = 'info') {
        const element = document.getElementById(elementId);
        element.style.display = 'block';
        element.className = `result ${type}`;
        element.innerHTML = message;
      }

      function testNavigation(path) {
        const fullUrl = `${window.location.origin}${path}`;

        showResult(
          'nav-result',
          `
                <strong>네비게이션 테스트:</strong><br>
                <code>${fullUrl}</code><br><br>
                <strong>예상 동작:</strong><br>
                • React Router가 해당 경로로 이동<br>
                • 해당 컴포넌트가 렌더링됨<br>
                • 브라우저 히스토리에 추가됨<br><br>
                <strong>실제 테스트:</strong> <a href="${fullUrl}" target="_blank">새 탭에서 열기</a>
            `,
          'info'
        );
      }

      function testOAuthCallback() {
        const mockToken = 'test_token_123';
        const mockUser = {
          id: 1,
          email: 'test@example.com',
          name: '테스트 사용자',
          userLevel: 1,
          currentTier: 1,
        };

        const callbackUrl = `${
          window.location.origin
        }/auth/callback?token=${mockToken}&user=${encodeURIComponent(
          JSON.stringify(mockUser)
        )}`;

        showResult(
          'oauth-nav-result',
          `
                <strong>OAuth 콜백 시뮬레이션:</strong><br>
                <code>${callbackUrl}</code><br><br>
                <strong>예상 동작:</strong><br>
                1. AuthCallbackPage 컴포넌트 렌더링<br>
                2. URL 파라미터에서 토큰과 사용자 정보 추출<br>
                3. 인증 스토어에 상태 저장<br>
                4. /dashboard로 리다이렉트<br><br>
                <strong>실제 테스트:</strong> <a href="${callbackUrl}" target="_blank">새 탭에서 열기</a>
            `,
          'success'
        );
      }

      function testOAuthError() {
        const errorUrl = `${window.location.origin}/auth/callback?error=google_auth_failed`;

        showResult(
          'oauth-nav-result',
          `
                <strong>OAuth 에러 시뮬레이션:</strong><br>
                <code>${errorUrl}</code><br><br>
                <strong>예상 동작:</strong><br>
                1. AuthCallbackPage 컴포넌트 렌더링<br>
                2. 에러 파라미터 감지<br>
                3. /login?error=google_auth_failed로 리다이렉트<br>
                4. 에러 메시지 표시<br><br>
                <strong>실제 테스트:</strong> <a href="${errorUrl}" target="_blank">새 탭에서 열기</a>
            `,
          'error'
        );
      }

      function testAuthenticatedRouting() {
        showResult(
          'auth-routing-result',
          `
                <strong>인증된 사용자 라우팅:</strong><br><br>
                <strong>접근 가능한 라우트:</strong><br>
                • /dashboard (메인 대시보드)<br>
                • /training (훈련 페이지)<br>
                • /mypage (마이페이지)<br>
                • /support (고객지원)<br><br>
                <strong>접근 시 리다이렉트되는 라우트:</strong><br>
                • /login → /dashboard<br>
                • /register → /dashboard<br><br>
                <strong>보호된 라우트:</strong><br>
                • /admin (관리자 권한 필요)
            `,
          'success'
        );
      }

      function testUnauthenticatedRouting() {
        showResult(
          'auth-routing-result',
          `
                <strong>미인증 사용자 라우팅:</strong><br><br>
                <strong>접근 가능한 라우트:</strong><br>
                • / (홈페이지)<br>
                • /login (로그인)<br>
                • /register (회원가입)<br><br>
                <strong>접근 시 리다이렉트되는 라우트:</strong><br>
                • /dashboard → /login<br>
                • /training → /login<br>
                • /mypage → /login<br>
                • /admin → /login<br><br>
                <strong>OAuth 콜백:</strong><br>
                • /auth/callback (인증 처리 후 /dashboard로 리다이렉트)
            `,
          'info'
        );
      }

      // 페이지 로드 시 현재 URL 정보 업데이트
      window.onload = function () {
        updateCurrentUrlInfo();
      };

      // URL 변경 시 정보 업데이트
      window.addEventListener('popstate', updateCurrentUrlInfo);
    </script>
  </body>
</html>
